This is the uPort serverside credentials demo app.
Repo: https://github.com/yshuman1/uport-server-side-demo.git
Instructions can be found at: https://developer.uport.me/uport-js/guides/server-side-credentials-example

For this example:

# **requestcredential.js**

##### The file requestcredential.js contains a service that will request the MNID identifier of the mobile application.

1. Install the uPort Mobile app.

2. Use ngrok: `$ ngrok http 8081`

3. Replace the endpoint on line 9 with the one from ngrok (make sure you use the https one).

4. I have created an app saved the credentials in the files. If you want to create your own app credentials visit: https://appmanager.uport.me/

5. `$ node requestcredential.js` Once you scan the QR code a jwt will print to your console.

##### If you successfully you should see the following on your console:

```
Service Output:
me.uport:me?requestToken=eyJ0eXAiOiJKV1QiLCJhbGciOiJFUzI1NksifQ.eyJpYXQiOjE1Mzc1ODk4ODEsInJlcXVlc3RlZCI6WyJpZGVudGl0eV9ubyJdLCJjYWxsYmFjayI6Imh0dHBzOi8vY2ZkNjI2ZDEubmdyb2suaW8vY2FsbGJhY2siLCJleHAiOjE1Mzc1OTAxODEsInR5cGUiOiJzaGFyZVJlcSIsImlzcyI6IjJvaGpoZ1p2VldRb1U0Znh4U2g3R2JuREMyeUs1Z25VZEFIIn0.ta2BKnjKBwvpkQ53mB
MvlDPmxOs22sMJ0i0gAmUKJNqlTfvurbXaNhEV5Aes7IkOct7MaEwLkXgMJ9vATjgwoA%26callback_type=post

JWT (access token):

eyJ0eXAiOiJKV1QiLCJhbGciOiJFUzI1NksifQ.eyJpYXQiOjE1Mzc1ODk4OTUsImV4cCI6MTUzNzY3NjI5NSwiYXVkIjoiMm9oamhnWnZWV1FvVTRmeHhTaDdHYm5EQzJ5SzVnblVkQUgiLCJ0eXBlIjoic2hhcmVSZXNwIiwibmFkIjoiMm9mYmpLRFZjQWpiNXBrU1p6d2pzQUt4V2RNd2M0endpQ3MiLCJvd24iOnt9LCJyZXEiOiJleUowZVhBaU9pSktWMVFpTENKaGJHY2lPaUpGVXpJMU5rc2lmUS5leUpwWVhRaU9qRTFNemMxT0RrNE9ERXNJbkpsY1hWbGMzUmxaQ0k2V3lKcFpHVnVkR2wwZVY5dWJ5SmRMQ0pqWVd4c1ltRmpheUk2SW1oMGRIQnpPaTh2WTJaa05qSTJaREV1Ym1keWIyc3VhVzh2WTJGc2JHSmhZMnNpTENKbGVIQWlPakUxTXpjMU9UQXhPREVzSW5SNWNHVWlPaUp6YUdGeVpWSmxjU0lzSW1semN5STZJakp2YUdwb1oxcDJWbGRSYjFVMFpuaDRVMmczUjJKdVJFTXllVXMxWjI1VlpFRklJbjAudGEyQktuaktCd3Zwa1E1M21CTXZsRFBteE9zMjJzTUowaTBnQW1VS0pOcWxUZnZ1cmJYYU5oRVY1QWVzN0lrT2N0N01hRXdMa1hnTUo5dkFUamd3b0EiLCJpc3MiOiIyb2ZiaktEVmNBamI1cGtTWnp3anNBS3hXZE13YzR6d2lDcyJ9.zIZn6tFxpMdYjeWDXLkTFtU5V-GGJhY9SoU5jSf0uQ9Wvs-cF8e6Q48FA_vuQGo0y5K6xTJt9-DKrHppcPZRHg

Decoded JWT:

{ address: '2ofbjKDVcAjb5pkSZzwjsAKxWdMwc4zwiCs',
did: '2ofbjKDVcAjb5pkSZzwjsAKxWdMwc4zwiCs',
networkAddress: '2ofbjKDVcAjb5pkSZzwjsAKxWdMwc4zwiCs',
publicKey: '0x04589467c4841610f634a23a9fee84eefb27bb10d5c93446264080bd17baf368807786f683559af9c117d5d25cd5f46e1835a7487fa2d49169d8f4a6902d6cff96',
publicEncKey: 'ya40edHkDa2gCXpz4xOk/N5tBolGaEQw7mo9jaIROQM=' }
```

- Please note the address value, that is the Multi Network Identifier (MNID). To learn more about MNID's read this: https://medium.com/uport/mnid-a-safer-way-of-encoding-blockchain-addresses-in-a-multi-chain-world-4222e7b62714

# **createcredential.js**

1. Use ngrok: `$ ngrok http 8081`

2. `node createcredential.js`

You should end up with a result similar to this:
Your phone should display an attestation that looks similar to this: https://imgur.com/yyHfPox

```
eyJ0eXAiOiJKV1QiLCJhbGciOiJFUzI1NksifQ.eyJpYXQiOjE1Mzc1OTEwNzEsInN1YiI6IjJvZmJqS0RWY0FqYjVwa1Naendqc0FLeFdkTXdjNHp3aUNzIiwiY2xhaW0iOnsiUHVsc2UgSUQgSW5mbyI6eyJlbWFpbCI6Inlhc2luQHB1bHNlYWdlbnQuY28iLCJUd2l0dGVyIjoiQHlhc2luMDQyNCIsIkxpbmtlZEluIjoiaHR0cHM6Ly93d3cubGlua2VkaW4uY29tL2luL3lzaHVtYW4vIn19LCJleHAiOjE1NTIwNDYwMjQsImlzcyI6IjJvaGpoZ1p2VldRb1U0Znh4U2g3R2JuREMyeUs1Z25VZEFIIn0.Zedf1KJWypswcGgwsiKgiqVtukzFqZasTDV3vXQ-0zguk9HLcmH3_-uMENetXwCbfHGRAUeFpfV9tW9xZz0WnA
{ header: { typ: 'JWT', alg: 'ES256K' },
  payload:
   { iat: 1537591071,
     sub: '2ofbjKDVcAjb5pkSZzwjsAKxWdMwc4zwiCs',
     claim: { 'Pulse ID Info': [Object] },
     exp: 1552046024,
     iss: '2ohjhgZvVWQoU4fxxSh7GbnDC2yK5gnUdAH' },
  signature: 'Zedf1KJWypswcGgwsiKgiqVtukzFqZasTDV3vXQ-0zguk9HLcmH3_-uMENetXwCbfHGRAUeFpfV9tW9xZz0WnA' }
me.uport:add?attestations=eyJ0eXAiOiJKV1QiLCJhbGciOiJFUzI1NksifQ.eyJpYXQiOjE1Mzc1OTEwNzEsInN1YiI6IjJvZmJqS0RWY0FqYjVwa1Naendqc0FLeFdkTXdjNHp3aUNzIiwiY2xhaW0iOnsiUHVsc2UgSUQgSW5mbyI6eyJlbWFpbCI6Inlhc2luQHB1bHNlYWdlbnQuY28iLCJUd2l0dGVyIjoiQHlhc2luMDQyNCIsIkxpbmtlZEluIjoiaHR0cHM6Ly93d3cubGlua2VkaW4uY29tL2luL3lzaHVtYW4vIn19LCJleHAiOjE1NTIwNDYwMjQsImlzcyI6IjJvaGpoZ1p2VldRb1U0Znh4U2g3R2JuREMyeUs1Z25VZEFIIn0.Zedf1KJWypswcGgwsiKgiqVtukzFqZasTDV3vXQ-0zguk9HLcmH3_-uMENetXwCbfHGRAUeFpfV9tW9xZz0WnA%26callback_type=post
```

# **verifycredential.js**

1. Use ngrok: `$ ngrok http 8081`

2. Replace the endpoint on line 9 with the one from ngrok.

3. `node createcredential.js`

##### If you do not have the credentials/attestation on your uPort app, you will recieve an response like this (rejection id: 1):

```
me.uport:me?requestToken=eyJ0eXAiOiJKV1QiLCJhbGciOiJFUzI1NksifQ.eyJpYXQiOjE1Mzc1OTE4NTMsInJlcXVlc3RlZCI6WyJpZGVudGl0eV9ubyIsIm5hbWUiLCJhdmF0YXIiLCJwaG9uZSIsImNvdW50cnkiXSwidmVyaWZpZWQiOlsiUHVsc2UgSUQgSW5mbyJdLCJjYWxsYmFjayI6Imh0dHBzOi8vY2ZkNjI2ZDEubmdyb2suaW8vY2FsbGJhY2siLCJleHAiOjE1Mzc1OTIxNTMsInR5cGUiOiJzaGFyZVJlcSIsImlzcyI6IjJvaGpoZ1p2VldRb1U0Znh4U2g3R2JuREMyeUs1Z25VZEFIIn0.Vh02P3OrEvCo_GuDJSh7psjZF7TedufIlvfWcArUvyQUQELcTiNxLOABmJPK4AjsbhJupZ3zlLdxVgCOgL8g5A%26callback_type=post
eyJ0eXAiOiJKV1QiLCJhbGciOiJFUzI1NksifQ.eyJpYXQiOjE1Mzc1OTE4NTcsImV4cCI6MTUzNzY3ODI1NywiYXVkIjoiMm9oamhnWnZWV1FvVTRmeHhTaDdHYm5EQzJ5SzVnblVkQUgiLCJ0eXBlIjoic2hhcmVSZXNwIiwibmFkIjoiMm9mYmpLRFZjQWpiNXBrU1p6d2pzQUt4V2RNd2M0endpQ3MiLCJvd24iOnsibmFtZSI6Illhc2luIiwiYXZhdGFyIjp7InVyaSI6Imh0dHBzOi8vaXBmcy5pbmZ1cmEuaW8vaXBmcy9RbWU5bjlrSGs0U1NXTGJ3bnVKY2Z6M0NCTmdBYmhGeHRLaGhjMXloblpFbmpyIn0sInBob25lIjoiKzE2Mjg2MDA4NzcyIiwiY291bnRyeSI6IlVTIn0sInJlcSI6ImV5SjBlWEFpT2lKS1YxUWlMQ0poYkdjaU9pSkZVekkxTmtzaWZRLmV5SnBZWFFpT2pFMU16YzFPVEU0TlRNc0luSmxjWFZsYzNSbFpDSTZXeUpwWkdWdWRHbDBlVjl1YnlJc0ltNWhiV1VpTENKaGRtRjBZWElpTENKd2FHOXVaU0lzSW1OdmRXNTBjbmtpWFN3aWRtVnlhV1pwWldRaU9sc2lVSFZzYzJVZ1NVUWdTVzVtYnlKZExDSmpZV3hzWW1GamF5STZJbWgwZEhCek9pOHZZMlprTmpJMlpERXVibWR5YjJzdWFXOHZZMkZzYkdKaFkyc2lMQ0psZUhBaU9qRTFNemMxT1RJeE5UTXNJblI1Y0dVaU9pSnphR0Z5WlZKbGNTSXNJbWx6Y3lJNklqSnZhR3BvWjFwMlZsZFJiMVUwWm5oNFUyZzNSMkp1UkVNeWVVczFaMjVWWkVGSUluMC5WaDAyUDNPckV2Q29fR3VESlNoN3BzalpGN1RlZHVmSWx2ZldjQXJVdnlRVVFFTGNUaU54TE9BQm1KUEs0QWpzYmhKdXBaM3psTGR4VmdDT2dMOGc1QSIsInZlcmlmaWVkIjpbXSwiaXNzIjoiMm9mYmpLRFZjQWpiNXBrU1p6d2pzQUt4V2RNd2M0endpQ3MifQ.prXeRF_w_iioEz5EA32RKT9PPpVBscBAe0WbCv9ErqQT9prbp_VOagbPzmBIegBVurpsfWCHMA8TVDW5iGrN2A
{ name: 'Yasin',
  avatar: { uri: 'https://ipfs.infura.io/ipfs/Qme9n9kHk4SSWLbwnuJcfz3CBNgAbhFxtKhhc1yhnZEnjr' },
  phone: '+16286008772',
  country: 'US',
  address: '2ofbjKDVcAjb5pkSZzwjsAKxWdMwc4zwiCs',
  did: '2ofbjKDVcAjb5pkSZzwjsAKxWdMwc4zwiCs',
  networkAddress: '2ofbjKDVcAjb5pkSZzwjsAKxWdMwc4zwiCs',
  publicKey: '0x04589467c4841610f634a23a9fee84eefb27bb10d5c93446264080bd17baf368807786f683559af9c117d5d25cd5f46e1835a7487fa2d49169d8f4a6902d6cff96',
  publicEncKey: 'ya40edHkDa2gCXpz4xOk/N5tBolGaEQw7mo9jaIROQM=',
  verified: [] }
(node:9981) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: 1): TypeError: Cannot read property 'sub' of undefined
(node:9981) [DEP0018] DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminatethe Node.js process with a non-zero exit code.
```

##### If successful it will look like this:

```
me.uport:me?requestToken=eyJ0eXAiOiJKV1QiLCJhbGciOiJFUzI1NksifQ.eyJpYXQiOjE1Mzc1OTIwNjUsInJlcXVlc3RlZCI6WyJpZGVudGl0eV9ubyIsIm5hbWUiLCJhdmF0YXIiLCJwaG9uZSIsImNvdW50cnkiXSwidmVyaWZpZWQiOlsiUHVsc2UgSUQgSW5mbyJdLCJjYWxsYmFjayI6Imh0dHBzOi8vY2ZkNjI2ZDEubmdyb2suaW8vY2FsbGJhY2siLCJleHAiOjE1Mzc1OTIzNjUsInR5cGUiOiJzaGFyZVJlcSIsImlzcyI6IjJvaGpoZ1p2VldRb1U0Znh4U2g3R2JuREMyeUs1Z25VZEFIIn0.B3KoHkpU_llCzQ0AC2Fynn8q7S8cCkOljZYSU8-nGQsghz57ZARHmZykd9IGQJfZ2YZKvyLVsKXQ9rl89KVUZA%26callback_type=post
eyJ0eXAiOiJKV1QiLCJhbGciOiJFUzI1NksifQ.eyJpYXQiOjE1Mzc1OTIwNzEsImV4cCI6MTUzNzY3ODQ3MSwiYXVkIjoiMm9oamhnWnZWV1FvVTRmeHhTaDdHYm5EQzJ5SzVnblVkQUgiLCJ0eXBlIjoic2hhcmVSZXNwIiwibmFkIjoiMm9mYmpLRFZjQWpiNXBrU1p6d2pzQUt4V2RNd2M0endpQ3MiLCJvd24iOnsibmFtZSI6Illhc2luIiwiYXZhdGFyIjp7InVyaSI6Imh0dHBzOi8vaXBmcy5pbmZ1cmEuaW8vaXBmcy9RbWU5bjlrSGs0U1NXTGJ3bnVKY2Z6M0NCTmdBYmhGeHRLaGhjMXloblpFbmpyIn0sInBob25lIjoiKzE2Mjg2MDA4NzcyIiwiY291bnRyeSI6IlVTIiwiUHVsc2UgSUQgSW5mbyI6eyJlbWFpbCI6Inlhc2luQHB1bHNlYWdlbnQuY28iLCJUd2l0dGVyIjoiQHlhc2luMDQyNCIsIkxpbmtlZEluIjoiaHR0cHM6Ly93d3cubGlua2VkaW4uY29tL2luL3lzaHVtYW4vIn19LCJyZXEiOiJleUowZVhBaU9pSktWMVFpTENKaGJHY2lPaUpGVXpJMU5rc2lmUS5leUpwWVhRaU9qRTFNemMxT1RJd05qVXNJbkpsY1hWbGMzUmxaQ0k2V3lKcFpHVnVkR2wwZVY5dWJ5SXNJbTVoYldVaUxDSmhkbUYwWVhJaUxDSndhRzl1WlNJc0ltTnZkVzUwY25raVhTd2lkbVZ5YVdacFpXUWlPbHNpVUhWc2MyVWdTVVFnU1c1bWJ5SmRMQ0pqWVd4c1ltRmpheUk2SW1oMGRIQnpPaTh2WTJaa05qSTJaREV1Ym1keWIyc3VhVzh2WTJGc2JHSmhZMnNpTENKbGVIQWlPakUxTXpjMU9USXpOalVzSW5SNWNHVWlPaUp6YUdGeVpWSmxjU0lzSW1semN5STZJakp2YUdwb1oxcDJWbGRSYjFVMFpuaDRVMmczUjJKdVJFTXllVXMxWjI1VlpFRklJbjAuQjNLb0hrcFVfbGxDelEwQUMyRnlubjhxN1M4Y0NrT2xqWllTVTgtbkdRc2doejU3WkFSSG1aeWtkOUlHUUpmWjJZWkt2eUxWc0tYUTlybDg5S1ZVWkEiLCJ2ZXJpZmllZCI6WyJleUowZVhBaU9pSktWMVFpTENKaGJHY2lPaUpGVXpJMU5rc2lmUS5leUpwWVhRaU9qRTFNemMxT1RJd05ETXNJbk4xWWlJNklqSnZabUpxUzBSV1kwRnFZalZ3YTFOYWVuZHFjMEZMZUZka1RYZGpOSHAzYVVOeklpd2lZMnhoYVcwaU9uc2lVSFZzYzJVZ1NVUWdTVzVtYnlJNmV5SmxiV0ZwYkNJNklubGhjMmx1UUhCMWJITmxZV2RsYm5RdVkyOGlMQ0pVZDJsMGRHVnlJam9pUUhsaGMybHVNRFF5TkNJc0lreHBibXRsWkVsdUlqb2lhSFIwY0hNNkx5OTNkM2N1YkdsdWEyVmthVzR1WTI5dEwybHVMM2x6YUhWdFlXNHZJbjE5TENKbGVIQWlPakUxTlRJd05EWXdNalFzSW1semN5STZJakp2YUdwb1oxcDJWbGRSYjFVMFpuaDRVMmczUjJKdVJFTXllVXMxWjI1VlpFRklJbjAuTERyX0ktczZFdkl1dlZ3bC1wa2Y0RHVwRzAzUG5xMEtkZ05qU2U5MVVxellYcklSYU5vZXhtc0s5ZkpGQkRCcGJzTkhteGRFRktVU0JfTkJnSzROS2ciXSwiaXNzIjoiMm9mYmpLRFZjQWpiNXBrU1p6d2pzQUt4V2RNd2M0endpQ3MifQ.vYKfT7Jmb2TIJrqUQQi6pbwDczmDoDQ9TbIoK_6BwEBeLU7EM_1fBYpkXrLrVFiooRId7F_nzsX4Kt4Q_FXLcQ
{ name: 'Yasin',
  avatar: { uri: 'https://ipfs.infura.io/ipfs/Qme9n9kHk4SSWLbwnuJcfz3CBNgAbhFxtKhhc1yhnZEnjr' },
  phone: '+16286008772',
  country: 'US',
  'Pulse ID Info':
   { email: 'yasin@pulseagent.co',
     Twitter: '@yasin0424',
     LinkedIn: 'https://www.linkedin.com/in/yshuman/' },
  address: '2ofbjKDVcAjb5pkSZzwjsAKxWdMwc4zwiCs',
  did: '2ofbjKDVcAjb5pkSZzwjsAKxWdMwc4zwiCs',
  networkAddress: '2ofbjKDVcAjb5pkSZzwjsAKxWdMwc4zwiCs',
  publicKey: '0x04589467c4841610f634a23a9fee84eefb27bb10d5c93446264080bd17baf368807786f683559af9c117d5d25cd5f46e1835a7487fa2d49169d8f4a6902d6cff96',
  publicEncKey: 'ya40edHkDa2gCXpz4xOk/N5tBolGaEQw7mo9jaIROQM=',
  verified:
   [ { iat: 1537592043,
       sub: '2ofbjKDVcAjb5pkSZzwjsAKxWdMwc4zwiCs',
       claim: [Object],
       exp: 1552046024,
       iss: '2ohjhgZvVWQoU4fxxSh7GbnDC2yK5gnUdAH',
       jwt: 'eyJ0eXAiOiJKV1QiLCJhbGciOiJFUzI1NksifQ.eyJpYXQiOjE1Mzc1OTIwNDMsInN1YiI6IjJvZmJqS0RWY0FqYjVwa1Naendqc0FLeFdkTXdjNHp3aUNzIiwiY2xhaW0iOnsiUHVsc2UgSUQgSW5mbyI6eyJlbWFpbCI6Inlhc2luQHB1bHNlYWdlbnQuY28iLCJUd2l0dGVyIjoiQHlhc2luMDQyNCIsIkxpbmtlZEluIjoiaHR0cHM6Ly93d3cubGlua2VkaW4uY29tL2luL3lzaHVtYW4vIn19LCJleHAiOjE1NTIwNDYwMjQsImlzcyI6IjJvaGpoZ1p2VldRb1U0Znh4U2g3R2JuREMyeUs1Z25VZEFIIn0.LDr_I-s6EvIuvVwl-pkf4DupG03Pnq0KdgNjSe91UqzYXrIRaNoexmsK9fJFBDBpbsNHmxdEFKUSB_NBgK4NKg' } ] }


Credential verified.
```
